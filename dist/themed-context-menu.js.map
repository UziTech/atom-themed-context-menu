{
  "version": 3,
  "sources": ["../src/main.ts", "../src/MenuItem.ts", "../src/ThemedContextMenu.ts", "../src/types.ts"],
  "sourcesContent": ["import { ThemedContextMenu } from \"./ThemedContextMenu\"\nimport { ElementI } from \"./types\"\nconst tcm = new ThemedContextMenu()\n\nexport async function activate() {\n    console.log(\"hello!\")\n    hijackAllContextMenus()\n}\n\nexport function deactivate() {}\n\nfunction hijackSingleContextMenu(domElement, items) {\n    domElement.addEventListener(\"contextmenu\", (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        console.log(items)\n\n        tcm.createContextMenu(e, items)\n    })\n}\n\nfunction hijackAllContextMenus() {\n    let contextMenuItems = (atom.contextMenu as any).itemSets.filter(\n        (item) => item.items.length > 1,\n    )\n\n    let elemList: ElementI[] = []\n    for (let i = 0; i < contextMenuItems.length; i++) {\n        let triggeringItem = contextMenuItems[i]\n        let domElems = document.querySelectorAll(triggeringItem.selector)\n        domElems.forEach((item) =>\n            elemList.push(new ElementI(item, triggeringItem.items)),\n        )\n    }\n\n    elemList = pruneElements(elemList)\n\n    elemList.forEach((item) => hijackSingleContextMenu(item.elem, item.items))\n}\n\nfunction pruneElements(elements: ElementI[]) {\n    console.log(elements.length)\n    for (let i = 0; i < elements.length; i++) {\n        for (let j = i + 1; j < elements.length; j++) {\n            if (elements[i].elem === elements[j].elem) {\n                elements[i].addItems(elements[j].items)\n                elements.splice(j, 1)\n            }\n        }\n    }\n    console.log(elements.length)\n    return elements\n}\n", "import EventEmitter from \"events\"\nimport { ContextMenuItem } from \"./types\"\nimport { ThemedContextMenu } from \"./ThemedContextMenu\"\n\nexport class MenuItem {\n    private element: HTMLHRElement | HTMLDivElement\n    private command?: string\n    private commandDetail?: string\n    private selected: boolean = false\n    private parent: ThemedContextMenu\n    private height: number\n\n    private constructor(\n        element: HTMLHRElement | HTMLDivElement,\n        parent: ThemedContextMenu,\n        height: number,\n    ) {\n        this.element = element\n        this.parent = parent\n        this.height = height\n\n        this.element.addEventListener(\"click\", (e) =>\n            this.onMouseClick(e as MouseEvent),\n        )\n    }\n\n    public static createMenuItem(\n        item: ContextMenuItem,\n        parent: ThemedContextMenu,\n    ) {\n        if (item.type === \"separator\") {\n            return new MenuItem(document.createElement(\"hr\"), parent, 7)\n        }\n\n        const divElem = document.createElement(\"div\")\n        divElem.classList.add(\"menu-item\")\n        const self = new MenuItem(divElem, parent, 23)\n\n        const menuItemName = document.createElement(\"span\")\n        menuItemName.classList.add(\"menu-item-name\")\n        menuItemName.innerHTML = item.label ? item.label : \"\"\n\n        const menuItemKey = document.createElement(\"span\")\n        menuItemKey.classList.add(\"menu-item-key\")\n\n        divElem.appendChild(menuItemName)\n        divElem.appendChild(menuItemKey)\n\n        if (item.command !== undefined) {\n            self.command = item.command\n            self.commandDetail = item.commandDetail\n\n            const keyStrokes = atom.keymaps.findKeyBindings({\n                command: item.command,\n            })\n            if (keyStrokes.length > 0) {\n                menuItemKey.innerHTML =\n                    keyStrokes[keyStrokes.length - 1].keystrokes\n            }\n        }\n\n        return self\n    }\n\n    public getElement() {\n        return this.element\n    }\n\n    public getHeight() {\n        return this.height\n    }\n\n    private onMouseClick(e: MouseEvent) {\n        e.stopPropagation()\n        this.execCommand()\n        this.parent.deleteContextMenu()\n    }\n\n    public async execCommand(): Promise<void> {\n        if (this.command === undefined) {\n            return\n        }\n\n        let target =\n            (atom.workspace.getActiveTextEditor() as any)?.getElement() ||\n            (atom.workspace.getActivePane() as any).getElement()\n\n        await (atom.commands as any).dispatch(\n            target,\n            this.command,\n            this.commandDetail,\n        )\n    }\n}\n", "import { MenuItem } from \"./MenuItem\"\n\nexport class ThemedContextMenu {\n    // private screenWrapper: HTMLDivElement\n    private activeContextMenu: HTMLDivElement | undefined\n    private aws: HTMLElement | null\n    private height: number\n\n    constructor() {\n        this.height = 0\n        this.aws = document.querySelector(\"atom-workspace\")\n        this.aws?.addEventListener(\"click\", (e) =>\n            this.onMouseClick(e as MouseEvent),\n        )\n    }\n\n    createContextMenu(e, items) {\n        this.deleteContextMenu()\n\n        this.activeContextMenu = document.createElement(\"div\")\n        this.activeContextMenu.classList.add(\"themed-context-menu\")\n\n        for (let i = 0; i < items.length; i++) {\n            this.addChild(items[i])\n        }\n\n        this.activeContextMenu.setAttribute(\"style\", this.getPosition(e))\n        this.aws?.appendChild(this.activeContextMenu)\n    }\n\n    private addChild(item) {\n        const mitem = MenuItem.createMenuItem(item, this)\n        this.activeContextMenu?.appendChild(mitem.getElement())\n        this.height += mitem.getHeight()\n    }\n\n    private onMouseClick(e) {\n        this.deleteContextMenu()\n    }\n\n    private getPosition(e) {\n        let x = e.clientX + 10 + 5\n        let y = e.clientY + 5\n\n        x = Math.min(x, window.innerWidth - 310)\n        y = Math.min(y, window.innerHeight - this.height - 10)\n\n        return \"top:\" + y + \"px; left:\" + x + \"px\"\n    }\n\n    deleteContextMenu() {\n        if (this.activeContextMenu) {\n            this.activeContextMenu.remove()\n            this.height = 0\n        }\n    }\n}\n", "export interface ContextMenuItem {\n    label?: string\n    command?: string\n    commandDetail?: any\n    type?: \"separator\"\n    // enabled?: boolean;\n    // visible?: boolean;\n    // submenu: IMenuItem[];\n}\n\nexport class ElementI {\n    elem: HTMLElement\n    items: ContextMenuItem[]\n\n    constructor(elem, items) {\n        this.elem = elem\n        this.items = items\n    }\n\n    addItems(items) {\n        items.forEach((element) => this.items.push(element))\n    }\n}\n"],
  "mappings": "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",
  "names": []
}
