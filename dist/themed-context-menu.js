var h=Object.defineProperty;var d=n=>h(n,"__esModule",{value:!0});var u=(n,e)=>{for(var t in e)h(n,t,{get:e[t],enumerable:!0})};d(exports);u(exports,{activate:()=>g,deactivate:()=>v});var a=class{constructor(e,t,i){this.selected=!1;this.element=e,this.parent=t,this.height=i,this.element.addEventListener("click",o=>this.onMouseClick(o))}static createMenuItem(e,t){if(e.type==="separator")return new a(document.createElement("hr"),t,7);let i=document.createElement("div");i.classList.add("menu-item");let o=new a(i,t,23),s=document.createElement("span");s.classList.add("menu-item-name"),s.innerHTML=e.label?e.label:"";let m=document.createElement("span");if(m.classList.add("menu-item-key"),i.appendChild(s),i.appendChild(m),e.command!==void 0){o.command=e.command,o.commandDetail=e.commandDetail;let l=atom.keymaps.findKeyBindings({command:e.command});l.length>0&&(m.innerHTML=l[l.length-1].keystrokes)}return o}getElement(){return this.element}getHeight(){return this.height}onMouseClick(e){e.stopPropagation(),this.execCommand(),this.parent.deleteContextMenu()}async execCommand(){var t;if(this.command===void 0)return;let e=((t=atom.workspace.getActiveTextEditor())==null?void 0:t.getElement())||atom.workspace.getActivePane().getElement();await atom.commands.dispatch(e,this.command,this.commandDetail)}};var r=class{constructor(){var e;this.height=0,this.aws=document.querySelector("atom-workspace"),(e=this.aws)==null||e.addEventListener("click",t=>this.onMouseClick(t))}createContextMenu(e,t){var i;this.deleteContextMenu(),this.activeContextMenu=document.createElement("div"),this.activeContextMenu.classList.add("themed-context-menu");for(let o=0;o<t.length;o++)this.addChild(t[o]);this.activeContextMenu.setAttribute("style",this.getPosition(e)),(i=this.aws)==null||i.appendChild(this.activeContextMenu)}addChild(e){var i;let t=a.createMenuItem(e,this);(i=this.activeContextMenu)==null||i.appendChild(t.getElement()),this.height+=t.getHeight()}onMouseClick(e){this.deleteContextMenu()}getPosition(e){let t=e.clientX+10+5,i=e.clientY+5;return t=Math.min(t,window.innerWidth-310),i=Math.min(i,window.innerHeight-this.height-10),"top:"+i+"px; left:"+t+"px"}deleteContextMenu(){this.activeContextMenu&&(this.activeContextMenu.remove(),this.height=0)}};var c=class{constructor(e,t){this.elem=e,this.items=t}addItems(e){e.forEach(t=>this.items.push(t))}};var p=new r;async function g(){console.log("hello!"),M()}function v(){}function x(n,e){n.addEventListener("contextmenu",t=>{t.preventDefault(),t.stopPropagation(),console.log(e),p.createContextMenu(t,e)})}function M(){let n=atom.contextMenu.itemSets.filter(t=>t.items.length>1),e=[];for(let t=0;t<n.length;t++){let i=n[t];document.querySelectorAll(i.selector).forEach(s=>e.push(new c(s,i.items)))}e=C(e),e.forEach(t=>x(t.elem,t.items))}function C(n){console.log(n.length);for(let e=0;e<n.length;e++)for(let t=e+1;t<n.length;t++)n[e].elem===n[t].elem&&(n[e].addItems(n[t].items),n.splice(t,1));return console.log(n.length),n}
//# sourceMappingURL=themed-context-menu.js.map
